{% extends "base.html" %}

{% block title %}Главная{% endblock title %}

{% block links %}
    <link rel="stylesheet" href="/static/home.css">
{% endblock links %}


{% block content %}
    <h1>Главная</h1>

    {% if context.user %}
        <h2 class="user-info"><b>Пользователь: </b>{{ context.user.username }}</h2>

        <div class="teams">
            {% if context.teams %}
                <h2>Команды</h2>
                    {% for team in context.teams %}
                        <div class="team-block">
                            <a href="/teams/{{ team.team_id }}" class="team-name">{{ team.name }}</a>
                            <p>Ваша роль: {{ team.role }}</p>
                        </div>
                        <div class="hor-line"></div>
                    {% endfor %}
            {% else %}
                <h2>Команды не найдены</h2>
            {% endif %}
        </div>

    {% else %}
        <h2 class="user-info">Вы не авторизованы</h2>
        <script>
            (() => {
                const token = document.cookie
                    .split("; ")
                    .find(row => row.startsWith("access_token="))
                    ?.split("=")[1];

                if (token) {
                    document.cookie = `access_token=;path=/;SameSite=Lax;max-age=0`;
                }
            })();
        </script>
    {% endif %}

{% endblock content %}
